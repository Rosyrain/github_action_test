name: Environment Secret Test
on:
  workflow_dispatch:

jobs:
  Environment:
    name: Pull_request Info
    runs-on: ubuntu-latest
    steps:
      - name: PR Info
        run: |
          echo "secrets = ${{secrets}}"
          echo "TOKEN=${{ secrets.ACTION_TOKEN }}"
      - name: Get issues
        run: |
          TOKEN=${{ secrets.ACTION_TOKEN }}
          issues=$(curl -L -H "Accept: application/vnd.github+json" -H "Authorization: Bearer $TOKEN" -H "X-GitHub-Api-Version: 2022-11-28" https://api.github.com/issues)
          if [[ $(echo $issues | jq 'length') -gt 0 ]]; then
            echo "$issues"
          else
            echo "Token might be invalid as no issues were retrieved."
          fi
  CI_test:
    name: CI_test secrets
    uses: Rosyrain/CI_test/.github/workflows/environment_secrets_test.yaml@main
    secrets: inherit